<!doctype html>
<html>
<head>
<meta charset="utf-8"/>
<title>上传组件验证的demo</title>
<link rel="stylesheet" type="text/css" href="http://docs.kissyui.com/kissy-dpl/base/build/css/dpl-pkg.css"/>
<link rel="stylesheet" type="text/css" href="assets/demo.css"/>
<script src="http://a.tbcdn.cn/s/kissy/1.2.0/kissy.js" charset="utf-8"></script>
<style>
    body {
        font-size: 12px;
        color: #404040;
    }

    .demo-wrapper {
        margin-top: 20px;
    }

    .btn-wrapper {
        margin-top: 10px;
    }
</style>
</head>
<body>

<article id="main">
    <h4>上传组件验证的demo</h4>
    <div class="demo-wrapper">
        <form action="test.php" id="J_Form">
            <!-- 按钮 -->
            <a id="J_UploaderBtn" class="uploader-button"
               data-config='{"type" : "auto",
                             "serverConfig":{"action":"upload.php","data":{"dir":"files/"}, "dataType" : "json"},
                             "name":"Filedata",
                             "urlsInputName":"imageUrls"}'
               data-auth="{}"
               href="#uploaderFile()">
                选择要上传的图片
            </a>
            <p>只允许上传jpg、gif、png、bmp格式，最大允许大小为1.0MB</p>
            <div id="J_UploaderMsg" class="valid-under uploader-auth-msg" style="height: 24px;display: none;" id="msgbox"><p class="estate error"><span class="label">此项为必填项。</span></p></div>
            <!-- 图片路径隐藏域 -->
            <input type="hidden" value="" id="J_ImageUrls" name="imageUrls" data-valid="{messagebox:'#J_UploaderMsg','uploader-max' : [1]}">
            <!-- 队列 -->
            <ul id="J_UploaderQueue">

            </ul>
        </form>
    </div>
    <script>
        var S = KISSY, $ = S.Node.all;
        S.config({
            packages:[
                {
                    name:"form",
                    path:"../../../",
                    charset:"utf-8"
                }
            ]
        });
        S.use('form/uploader/render,validation', function (S, RenderUploader, Validation) {
            var ru = new RenderUploader('#J_UploaderBtn', '#J_UploaderQueue');
            ru.on("init", function (ev) {
                /*var uploader = ev.uploader,
                    form = S.get('#J_Form'),
                    //kissy的验证类实例化
                    check = new Validation(form, {
                        isok:false,
                        anim:0.3,
                        style:"under"
                    }),
                    uploaderCheck = check.get("Filedata"),
                    urlsCheck = check.get('J_ImageUrls'),
                    uploaderAuth = new UploaderAuth({fileField:uploaderCheck, uploader:uploader, urlsField:urlsCheck });
                uploaderAuth.render();*/
                var uploader = ev.uploader;
            })
        })
    </script>
</article>
<!-- 代码高亮 START  -->
<link href='../../../../tool/syntaxhighlighter_3.0.83/sh.css' rel='stylesheet' type='text/css' />
<script type="text/javascript" src="../../../../tool/syntaxhighlighter_3.0.83/sh.js"></script>
<script type="text/javascript">SyntaxHighlighter.all();</script>
<!-- 代码高亮 END  -->
</body>
</html>