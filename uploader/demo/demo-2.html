<!doctype html>
<html>
<head>
<meta charset="utf-8"/>
<title>Uploader—异步文件上传demo</title>
<script src="http://a.tbcdn.cn/s/kissy/1.2.0/kissy.js"></script>
<style>
    body {
        font-size: 12px;
        color: #404040;
    }

    .demo-wrapper {
        margin-top: 20px;
    }

    .btn-wrapper {
        margin-top: 10px;
    }
</style>
</head>
<body>

<article id="main">
    <h4>iframe异步文件上传组件</h4>
    <p>为了简化demo去掉了上传验证类的初始化，目前组件效果和可用性上还有些问题，代码和API还在重构中，欢迎反馈问题:)</p>
    <div class="demo-wrapper">
        <form action="test.php">
            <a id="J_UploaderBtn" class="g-u uploader-button uploader-button-focus" data-config='{"type" : "auto","serverConfig":{"action":"upload.php","data":{"dir":"files/"},"dataType" : "json"},"name":"Filedata","urlsInputName":"attachments"}' data-valid='{"max" : []}' href="#uploaderFile()">
                选择要上传的图片
            </a>
            <ul id="J_UploaderQueue">

            </ul>
            <div class="fieldset">
                <span class="legend">组件配置</span>
                <div id="config-form">
                    <!--<div class="row">
                        <label for="">上传方式：</label>
                        <input class="J_UploadType" name="uploadType[]" value="auto" type="radio">
                        <label for="">auto</label>
                        <input class="J_UploadType" name="uploadType[]" value="auto" type="radio">
                        <label for="">ajax</label>
                        <input class="J_UploadType" name="uploadType[]" value="auto" type="radio">
                        <label for="">iframe</label>
                    </div>-->
                    <div class="row">
                        <input class="J_AutoUpload" value="1" name="autoUpload" checked="checked" type="checkbox">
                        <label for="autoUpload">自动上传</label>
                    </div>
                </div>
            </div>
            <div class="btn-wrapper">
                <input id="J_UploadAll" type="button" value="上传所有等待的文件">
            </div>
        </form>
    </div>
    <script>
        KISSY.Config.base = '../../';
        KISSY.use('node', function(S, Node) {
            var $ = Node.all;
            KISSY.use('uploader/render', function(S, RenderUploader) {
                var renderUploader = new RenderUploader('#J_UploaderBtn', '#J_UploaderQueue'),
                        uploader = renderUploader.get('uploader');
                $('.J_AutoUpload').on('change', function(ev) {
                    var checked = $(ev.target).prop('checked');
                    uploader.set('autoUpload', checked);
                });
                $('#J_UploadAll').on('click', function(ev) {
                    uploader.uploadAll();
                })
            })
        });
    </script>
</article>
</body>
</html>